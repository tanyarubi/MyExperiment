<!DOCTYPE html>
<html>
    <head>
        <title>My experiment</title>
		<script src="jspsych-6.3.1/jspsych.js"></script>
		<script src="jspsych-6.3.1/plugins/jspsych-html-keyboard-response.js"></script>
	        <script src="jspsych-6.3.1/plugins/jspsych-instructions.js"></script>
		<script src="jspsych-6.3.1/plugins/jspsych-html-slider-response.js"></script>
		<script src="jspsych-6.3.1/plugins/jspsych-image-keyboard-response.js"></script>
		<script src="jspsych-6.3.1/plugins/jspsych-preload.js"></script>
	        <script src="jspsych-6.3.1/plugins/jspsych-animation.js"></script>
		<script src="jspychophysics/jspsych-psychophysics.js"></script>
		<link href="jspsych-6.3.1/css/jspsych.css" rel="stylesheet" type="text/css">
	    	<script src="stochasm.js"></script>
		
		
    </head>
    <body></body>
	

	
	
	<script>
	//flow paramaters */ 
	var Npractice = 1;
	var Ntrials = 2;
	var show_RT = 500; //milisec
	
	//pardigm parameters
	var sigma = 20;
	var sampleSize = 8;
	var max_n = 100
	var min_n = 0
	var c = 30 //constant that bounds the scale for the samples' mean

	// create timeline:
	var timeline = [];
	let ranNumAr = [];
		
	// generate a random subject ID with 15 characters
	var subject_id = jsPsych.randomization.randomID(4);
	
	// pick a random condition for the subject at the start of the experiment
	// record the condition assignment in the jsPsych data
	var condition_assignment = jsPsych.randomization.sampleWithoutReplacement(['conditionIndifFirst', 'conditionGroupFirst'], 1)[0];


	// this adds a property called 'subject' and a property called 'condition' to every trial
	jsPsych.data.addProperties({
	  subject: subject_id,
	  condition: condition_assignment
	});

    /* define welcome message trial */
    var welcome = {
      type: "html-keyboard-response",
      stimulus: "Welcome to the experiment. Press any key to begin."
    };
    timeline.push(welcome);

    /* define instructions trials */
    var instructions = {
      type: "html-keyboard-response",
      stimulus: `
        <p>Thank you for taking part in our study!</p>
		<p>In this study we will ask you to help us evaluate peopleâ€™s average level of physical activity.</p>
		<p>To do this, we had volunteers wear a fitness watch, which kept track of the number of minutes they engaged 
		in aerobic physical activity (walking, jogging, dancing, intense house work) on a particular day. </p>

        
        <p>Press any key to begin.</p>
       `,
      post_trial_gap: 2000
    };
	timeline.push(instructions);
	
	

    var instruct_indiv_first = {
      type: "html-keyboard-response",
      stimulus: `
        <p>We will show you data from the fitness watch of <b>one individual</b>, who wore it for eight consecutive days.
		<p>We will then ask you to evaluate the average of that individual.  
        <p>Press any key to begin.</p>
       `,
      post_trial_gap: 2000
    };
	timeline.push(instruct_indiv_first)
		
	var instruct_indiv_second = {
      type: "html-keyboard-response",
      stimulus: `
        <p>We will now show you data from the fitness watch of <b>one individual</b>, who wore it for eight consecutive days.
		<p>We will then ask you to evaluate the average of that individual.

        <p>Press any key to begin.</p>
       `,
      post_trial_gap: 2000
    };
	
	var instruct_group_first = {
      type: "html-keyboard-response",
      stimulus: `
        <p>We will show you data from fitness watches of <b>eight different people</b>.
		<p>We will then ask you to evaluate the average of that <b>group of people</b>.
        <p>Press any key to begin.</p>
       `,
      post_trial_gap: 2000
    };
	
	var instruct_group_second = {
      type: "html-keyboard-response",
       stimulus: `
        <p>We will now show you data from fitness watches of <b>eight different people</b>
	       <p>We will then ask you to evaluate the average of that <b>group of people</b>
        <p>Press any key to begin</b>
       `,
      post_trial_gap: 2000
}
	timeline.push(instruct_group_second)


	var slider_group = {
    type: 'html-slider-response',
	stimulus: [],
    labels: ['0','25','50','75','100'],
    prompt: `<p>What was this group's activity level?</p>`,
		on_load: function()  {
    var input = document.querySelector('#jspsych-html-slider-response-response')

    input.addEventListener('input', function() {
      document.querySelector('#answer-display').innerText = input.valueAsNumber.toString()
    })

  }
		
    
	}

	var slider_indiv = {
    type: 'html-slider-response',
	stimulus: [`<p>What was this person's activity level?</p>`],
    labels: ['0','25','50','75','100'],
    prompt:  '<p>Your answer is <span id="answer-display"></span></p>',
    on_load: function()  {
    var input = document.querySelector('#jspsych-html-slider-response-response')

    input.addEventListener('input', function() {
      document.querySelector('#answer-display').innerText = input.valueAsNumber.toString()
    })

  }
	}
	
	var data = jsPsych.data.get().filter({trial_type: 'html-slider-response'});
	
	
for (var j = 0; j < Ntrials; j++) { 
    ranNumAr[j] = stochasm({kind: "integer",mean: 75, stdev: 14, min: 0, max: 100})

	//create trial function
    var node = {
	    timeline:[
        {
            type: 'html-keyboard-response',
            stimulus: '+',
            choices: jsPsych.NO_KEYS,
            trial_duration: 500,
				
        },
        {
            type: 'html-keyboard-response',
            stimulus: ranNumAr[j][0],
            choices: jsPsych.NO_KEYS,
            trial_duration: 1000
        },
	      {
            type: 'html-keyboard-response',
            stimulus: ranNumAr[j][1],
            choices: jsPsych.NO_KEYS,
		trial_duration: 1000
	     },
	      {
            type: 'html-keyboard-response',
            stimulus: ranNumAr[j][2],
            choices: jsPsych.NO_KEYS,
		trial_duration: 1000
	     },
	    	      {
            type: 'html-keyboard-response',
            stimulus: ranNumAr[j][3],
            choices: jsPsych.NO_KEYS,
		trial_duration: 1000
	     },
	    	      {
            type: 'html-keyboard-response',
            stimulus: ranNumAr[j][4],
            choices: jsPsych.NO_KEYS,
		trial_duration: 1000
	     },
	    	      {
            type: 'html-keyboard-response',
            stimulus: ranNumAr[j][5],
            choices: jsPsych.NO_KEYS,
		trial_duration: 1000
	     },
	    	      {
            type: 'html-keyboard-response',
            stimulus: ranNumAr[j][6],
            choices: jsPsych.NO_KEYS,
		trial_duration: 1000
	     },
	    	      {
            type: 'html-keyboard-response',
            stimulus: ranNumAr[j][7],
            choices: jsPsych.NO_KEYS,
		trial_duration: 1000,
		data: { trial_count: j },
		}],
    }
	    timeline.push(node);
	timeline.push(slider_indiv);
};

	/* start the experiment */
	     
    jsPsych.init({
      timeline: timeline,
	  on_finish: function() {
        jsPsych.data.displayData('csv');
		jsPsych.data.get().localSave('csv','mydata.csv');
    }
    });

	
    </script>
</html>
