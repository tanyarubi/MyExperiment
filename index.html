<!DOCTYPE html>
<html>
    <head>
        <title>My experiment</title>
		<script src="jspsych-6.3.1/jspsych.js"></script>
		<script src="jspsych-6.3.1/plugins/jspsych-html-keyboard-response.js"></script>
	        <script src="jspsych-6.3.1/plugins/jspsych-instructions.js"></script>
		<script src="jspsych-6.3.1/plugins/jspsych-html-slider-response.js"></script>
		<script src="jspsych-6.3.1/plugins/jspsych-image-keyboard-response.js"></script>
		<script src="jspsych-6.3.1/plugins/jspsych-preload.js"></script>
	        <script src="jspsych-6.3.1/plugins/jspsych-animation.js"></script>
		<script src="jspychophysics/jspsych-psychophysics.js"></script>
		<link href="jspsych-6.3.1/css/jspsych.css" rel="stylesheet" type="text/css">
		
		
    </head>
    <body></body>
	

	
	
	<script>
	//flow paramaters */ 
	var Npractice = 1;
	var Ntrials = 2;
	var show_RT = 500; //milisec
	
	//pardigm parameters
	var sigma = 20;
	var sampleSize = 8;
	var max_n = 100
	var min_n = 0
	var c = 30 //constant that bounds the scale for the samples' mean
	
	let ranNumAr = [];
	let ranNumStr = [];
	let backToArr = [];
	/* create timeline */
    	var timeline = [];
	var trial_count = 0;
		
	// generate a random subject ID with 15 characters
	var subject_id = jsPsych.randomization.randomID(4);
	
	// pick a random condition for the subject at the start of the experiment
	var condition_assignment = jsPsych.randomization.sampleWithoutReplacement(['conditionIndifFirst', 'conditionGroupFirst'], 1)[0];

	// record the condition assignment in the jsPsych data
	// this adds a property called 'subject' and a property called 'condition' to every trial
	jsPsych.data.addProperties({
	  subject: subject_id,
	  condition: condition_assignment
	});

    /* define welcome message trial */
    var welcome = {
      type: "html-keyboard-response",
      stimulus: "Welcome to the experiment. Press any key to begin."
    };
    timeline.push(welcome);

    /* define instructions trials */
    var instructions = {
      type: "html-keyboard-response",
      stimulus: `
        <p>Thank you for taking part in our study!</p>
		<p>In this study we will ask you to help us evaluate peopleâ€™s average level of physical activity.</p>
		<p>To do this, we had volunteers wear a fitness watch, which kept track of the number of minutes they engaged 
		in aerobic physical activity (walking, jogging, dancing, intense house work) on a particular day. </p>

        
        <p>Press any key to begin.</p>
       `,
      post_trial_gap: 2000
    };
	timeline.push(instructions);
	
	

    var instruct_indiv_first = {
      type: "html-keyboard-response",
      stimulus: `
        <p>We will show you data from the fitness watch of <b>one individual</b>, who wore it for eight consecutive days.
		<p>We will then ask you to evaluate the average of that individual.  
        <p>Press any key to begin.</p>
       `,
      post_trial_gap: 2000
    };
	timeline.push(instruct_indiv_first)
		
	var instruct_indiv_second = {
      type: "html-keyboard-response",
      stimulus: `
        <p>We will now show you data from the fitness watch of <b>one individual</b>, who wore it for eight consecutive days.
		<p>We will then ask you to evaluate the average of that individual.

        <p>Press any key to begin.</p>
       `,
      post_trial_gap: 2000
    };
	
	var instruct_group_first = {
      type: "html-keyboard-response",
      stimulus: `
        <p>We will show you data from fitness watches of <b>eight different people</b>.
		<p>We will then ask you to evaluate the average of that <b>group of people</b>.
        <p>Press any key to begin.</p>
       `,
      post_trial_gap: 2000
    };
	
	var instruct_group_second = {
      type: "instructions",
       pages: [
        'We will now show you data from fitness watches of <b>eight different people',
	       'We will then ask you to evaluate the average of that <b>group of people',
        'Press any key to begin'
       ],
      show_clickable_nav: true
}
	timeline.push(instruct_group_second)

for (i=0; i<Ntrials; i++){
		ranNumAr[i] = [...Array(8)].map(e=>~~(Math.random()*101));}
	
	
var sequence = []		

	//create trial function
	
		
	

	var test_trial = {
    timeline: [
        {
            type: 'html-keyboard-response',
            stimulus: '+',
            choices: jsPsych.NO_KEYS,
            trial_duration: 500
        },
        {
            type: 'html-keyboard-response',
            stimulus: ranNumAr[trial_count][0],
            choices: jsPsych.NO_KEYS,
            trial_duration: 1000
        },
	      {
            type: 'html-keyboard-response',
            stimulus: ranNumAr[trial_count][1],
            choices: jsPsych.NO_KEYS,
		trial_duration: 1000
	     },
	      {
            type: 'html-keyboard-response',
            stimulus: ranNumAr[trial_count][2],
            choices: jsPsych.NO_KEYS,
		trial_duration: 1000
	     },
	    	      {
            type: 'html-keyboard-response',
            stimulus: ranNumAr[trial_count][3],
            choices: jsPsych.NO_KEYS,
		trial_duration: 1000
	     },
	    	      {
            type: 'html-keyboard-response',
            stimulus: ranNumAr[trial_count][4],
            choices: jsPsych.NO_KEYS,
		trial_duration: 1000
	     },
	    	      {
            type: 'html-keyboard-response',
            stimulus: ranNumAr[trial_count][5],
            choices: jsPsych.NO_KEYS,
		trial_duration: 1000
	     },
	    	      {
            type: 'html-keyboard-response',
            stimulus: ranNumAr[trial_count][6],
            choices: jsPsych.NO_KEYS,
		trial_duration: 1000
	     },
	    	      {
            type: 'html-keyboard-response',
            stimulus: ranNumAr[trial_count][7],
            choices: jsPsych.NO_KEYS,
		trial_duration: 1000,
		data: { trial_count: trial_count },
		on_finish: function(data) {
			data.trial_i = trial_count;
    		trial_count = trial_count + 1;
		}	   
	     }
    ]
}
	

	var slider_group = {
    type: 'html-slider-response',
	stimulus: [],
    labels: ['0','100'],
    prompt: `<p>What was this group's activity level?</p>`,
		
    data: {sequence}
	}

	var slider_indiv = {
    type: 'html-slider-response',
	stimulus: [],
    labels: ['0','100'],
    prompt: `<p>What was this person's activity level?</p>`,
    data: {sequence},
}
	}
	
	var data = jsPsych.data.get().filter({trial_type: 'html-slider-response'});
	
	
		
	var node = {
    timeline: [test_trial, slider_indiv],
    repetitions: 3,
	}
	
	
	
	/* start the experiment */
    jsPsych.init({
      timeline: [node],
	  on_finish: function() {
        jsPsych.data.displayData('csv');
		jsPsych.data.get().localSave('csv','mydata.csv');
    }
    });

	
    </script>
</html>
